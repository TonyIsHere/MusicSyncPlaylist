<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
	crossorigin="anonymous">
<link rel="stylesheet"
	href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
	integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p"
	crossorigin="anonymous" />

<script
	src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
	integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
	crossorigin="anonymous"></script>
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
	integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
	crossorigin="anonymous"></script>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<title>New Playlist</title>
</head>
<body>
<div th:insert="navbar">...</div>
	<div class="container">
		<div class="row justify-content-md-center" style="margin-top: 10px">
			<div class="col col-md-6">
				<h2 th:text="${name}" class="text-center" >Name</h2>
				<ul class="list-unstyled"
					style="max-height: 70vh; overflow-y: auto;">
					<li th:each="item : ${playlist}"
						th:id="'item-search-'+${item.primaryKey.track.id}"
						class="border rounded item-to-add"
						style="padding: 10px; margin-top: 10px"><a target="_blank"
						th:href="'https://open.spotify.com/track/' + ${item.primaryKey.track.spotify}">Spotify
							link</a>
						<div class="d-flex align-items-center">
							<div class="flex-shrink-0">
								<img th:src="${item.primaryKey.track.album.picture}"
									alt="playlist" class="img-thumbnail" style="width: 100px">
							</div>
							<div class="flex-grow-1 ms-3">
								<h5 class="mt-0 mb-1" th:text="${item.primaryKey.track.name}"></h5>
								<p th:text="${item.primaryKey.track.getArtistsString}"></p>
								<span th:if="${item.primaryKey.track.preview == Null}"></span> <span
									th:unless="${item.primaryKey.track.preview == Null }">
									<Button
										th:attr="onclick=|playAudio('${item.primaryKey.track.id}')|">Play
										preview</Button> <audio th:id="'btn_'+${item.primaryKey.track.id}"
										controls class="d-none" style="height: revert; width: 100%">
										<source th:src="${item.primaryKey.track.preview}"
											type="audio/mpeg">
										Your browser does not support the audio element.
									</audio>
								</span>
							</div>
							<a type="button"th:href="'/track/'+${item.primaryKey.track.id}" class="btn btn-success btn-lg float-right btn-add">
								more...
							</a>
						</div></li>
				</ul>
			</div>
		</div>
	</div>
</body>
<script>
function playAudio(btnid)
{
	el = document.getElementById("btn_"+btnid);
	
	$('audio').each((i,x) => {
		x.pause()
		if(x !== el)
			{
			x.currentTime = 0;
			}
	});
	console.log(el.currentTime);
	if(el.currentTime != 0) //On listen
		{
		el.pause()
		el.currentTime = 0;
		}
	else
		{
		el.currentTime = 0;
		el.play();
		}
}

</script>
</html>
